# syntax=docker/dockerfile:1
FROM golang:1.16-alpine

RUN apk add --update gcc
WORKDIR /app

RUN go mod download
RUN go build -o ./vouch-scorer

CMD [ "/app/vouch-scorer" ]

FROM alpine:latest 

ENV NIM_VERSION 0.14.2
RUN apk add --update git
RUN apk add --no-cache g++ curl tar xz

RUN apt-get install build-essential git cmake

RUN git clone https://github.com/michaelsproul/nimbus-eth2.git /app
WORKDIR /app
RUN ls -l
RUN make -j4 nimbus_beacon_node

ADD ./run-mainnet-beacon-node.sh /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh"]